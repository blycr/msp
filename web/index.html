<!doctype html>
<html lang="zh-CN">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>MSP 局域网媒体分享预览</title>
  <link rel="stylesheet" href="/assets/plyr/plyr.css" />
  <link rel="icon" href="/logo.svg" type="image/svg+xml" />
</head>

<body>
  <header class="topbar">
    <div class="topbar__title" id="topbarTitle" data-i18n="title">MSP Media Share</div>
    <div class="topbar__meta" id="meta"></div>
    <button class="theme-btn" id="langBtn" title="Language"
      style="margin-right: 4px; font-size: 14px; font-weight: bold;">EN</button>
    <button class="theme-btn" id="themeBtn" title="Switch Theme" aria-label="Switch Theme"></button>
    <button class="btn btn--ghost" id="btnSettings" data-i18n="settings">Settings</button>
    <button class="btn btn--ghost" id="btnRefresh" data-i18n="refresh">Refresh</button>
  </header>

  <main class="layout">
    <aside class="panel sidebar">
      <div class="tabs" role="tablist">
        <button class="tab tab--active" data-tab="video" data-i18n="tab_video">Video</button>
        <button class="tab" data-tab="audio" data-i18n="tab_audio">Audio</button>
        <button class="tab" data-tab="image" data-i18n="tab_image">Image</button>
        <button class="tab" data-tab="other" id="tabOther" hidden data-i18n="tab_other">Other</button>
      </div>

      <div class="search">
        <input class="textfield" id="q" placeholder="Search..." data-i18n-ph="search_ph" />
        <div class="row" style="margin-top: 8px;">
          <select class="textfield" id="sortField" style="flex: 1;">
            <option value="name" data-i18n="sort_name">Name</option>
            <option value="size" data-i18n="sort_size">Size</option>
            <option value="date" data-i18n="sort_date">Date</option>
          </select>
          <button class="btn btn--ghost" id="sortOrder" title="Order" data-i18n-title="sort_order"
            style="padding: 8px 12px; display: flex; align-items: center; justify-content: center;"
            aria-label="Toggle sort order">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
              stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width: 16px; height: 16px;">
              <line x1="12" y1="5" x2="12" y2="19"></line>
              <polyline points="19 12 12 19 5 12"></polyline>
            </svg>
          </button>
        </div>
      </div>

      <div class="list__body" id="list"></div>
      <div class="hint" id="hint"></div>
    </aside>

    <section class="panel stage">
      <div class="now">
        <div class="now__title" id="previewTitle" data-i18n="preview_none">No Selection</div>
        <div class="now__sub" id="previewSub"></div>
        <div class="now__actions">
          <button class="btn btn--ghost" id="btnPrev" disabled data-i18n="prev">Prev</button>
          <button class="btn btn--ghost" id="btnNext" disabled data-i18n="next">Next</button>
          <div class="row" id="shuffleWrap" hidden>
            <label class="toggle">
              <input type="checkbox" id="toggleShuffle" />
              <span data-i18n="shuffle">Shuffle</span>
            </label>
            <label class="toggle">
              <input type="checkbox" id="toggleLoop" />
              <span data-i18n="loop">Loop</span>
            </label>
          </div>
          <button class="btn" id="btnResume" disabled hidden data-i18n="resume">Resume</button>
          <button class="btn" id="btnOpenRaw" disabled data-i18n="open_raw">Open Raw</button>
          <button class="btn btn--ghost" id="btnToggleFit" disabled hidden data-i18n="fit_mode">Fit Mode: Adapt</button>
        </div>
      </div>

      <div class="playerbox" id="playerBox">
        <video id="videoEl" playsinline controls preload="metadata"></video>
        <audio id="audioEl" controls preload="metadata"></audio>
        <div class="audioMeta" id="audioMeta">
          <img class="audioCover" id="audioCover" alt="" />
          <div class="lyrics" id="lyrics"></div>
        </div>
        <img id="imgEl" alt="" />
        <div class="empty" id="emptyEl" data-i18n="empty_tip">Select a file to preview</div>
      </div>
    </section>

    <aside class="panel playlist" id="playlistPanel">
      <div class="playlist__title" data-i18n="playlist">Playlist</div>
      <div class="playlist__meta" id="plMeta" data-i18n="not_loaded">Not Loaded</div>
      <div class="playlist__body" id="plList"></div>
    </aside>
  </main>

  <footer class="footer">
    <p class="footer__line">
      <span class="footer__copy">&copy; 2026</span>
      <span class="footer__brand">MSP</span>
      <span class="footer__sep">·</span>
      <span class="footer__text" data-i18n="footer_text">A simple media server for personal use.</span>
      <span class="footer__sep">·</span>
      <a class="footer__link" href="https://github.com/blycr/msp" target="_blank" rel="noreferrer">GitHub</a>
    </p>
  </footer>

  <!-- PIN Authentication Dialog -->
  <div class="dialog__backdrop" id="pinBackdrop" hidden></div>
  <section class="dialog" id="pinDlg" hidden aria-modal="true" role="dialog" style="max-width: 400px;">
    <div class="dialog__title" id="pinDlgTitle">Authentication Required</div>
    <div class="dialog__body">
      <div class="dialog__note" style="margin-bottom: 1rem; line-height: 1.5;" id="pinDlgNote">
        Please enter the PIN code to access this service.
      </div>
      <div class="row">
        <input class="textfield" id="pinInput" type="password" placeholder="Enter PIN" autocomplete="off"
          style="flex: 1; font-size: 1.1rem; padding: 12px; text-align: center; letter-spacing: 0.2em;" />
      </div>
      <div id="pinError"
        style="color: var(--md-danger); margin-top: 0.5rem; font-size: 0.9rem; text-align: center; min-height: 1.5rem;">
      </div>
    </div>
    <div class="dialog__actions">
      <button class="btn" id="btnSubmitPin">Submit</button>
    </div>
  </section>

  <div class="dialog__backdrop" id="dlgBackdrop" hidden></div>
  <section class="dialog" id="dlg" hidden aria-modal="true" role="dialog">
    <div class="dialog__title" data-i18n="dlg_title">Share Settings</div>
    <div class="dialog__body">
      <div class="row">
        <input class="textfield" id="sharePath" placeholder="e.g. D:\Media" data-i18n-ph="path_ph" />
      </div>
      <div class="row">
        <input class="textfield" id="shareLabel" placeholder="Alias (Optional)" data-i18n-ph="label_ph" />
        <button class="btn" id="btnAddShare" data-i18n="add">Add</button>
      </div>

      <div class="sharelist" id="shareList"></div>

      <div class="dialog__subtitle" data-i18n="bl_title">Blacklist Settings</div>
      <div class="row">
        <input class="textfield" id="blExts" placeholder="Block Exts" data-i18n-ph="bl_exts_ph" />
      </div>
      <div class="row">
        <input class="textfield" id="blFiles" placeholder="Block Files" data-i18n-ph="bl_files_ph" />
      </div>
      <div class="row">
        <input class="textfield" id="blFolders" placeholder="Block Folders" data-i18n-ph="bl_folders_ph" />
      </div>
      <div class="row">
        <input class="textfield" id="blMinSize" type="text" placeholder="Block Size" data-i18n-ph="bl_size_ph" />
      </div>
      <div class="dialog__note"
        style="font-size: 0.85rem; color: var(--text-sub); margin-bottom: 0.5rem; line-height: 1.4;" id="blHint">
        Usage:<br>1. Regex...
      </div>
      <div class="row">
        <button class="btn" id="btnSaveBlacklist" data-i18n="save_bl">Save Blacklist</button>
      </div>

      <div class="small" data-i18n="dlg_note">
        Note: Web cannot open folder picker due to security limits. Please input path manually.
      </div>
    </div>
    <div class="dialog__actions">
      <button class="btn btn--ghost" id="btnCloseDlg" data-i18n="close">Close</button>
    </div>
  </section>

  <script src="/assets/pinyin-pro/pinyin-pro.js"></script>
  <script src="/assets/plyr/plyr.polyfilled.js"></script>
  <script type="module" src="/src/app.js"></script>
</body>

</html>